<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script>
        AFRAME.registerComponent('threejs-circle-animation', {
            init: function() {
                // Wait for the scene to load
                const el = this.el;
                
                this.scene = el.sceneEl.object3D;
                this.radius = 0.1;
                this.angle = 0;
                this.speed = 0.02;
                this.center = new THREE.Vector3(0, 0, 0.1);
                
                // Create a simple cube with Three.js
                const geometry = new THREE.BoxGeometry(0.05, 0.05, 0.05);
                const material = new THREE.MeshStandardMaterial({
                    color: 0x00ff00,
                    metalness: 0.5,
                    roughness: 0.5
                });
                
                this.cube = new THREE.Mesh(geometry, material);
                this.cube.position.copy(this.center);
                
                // Add the cube to the entity's object3D
                el.object3D.add(this.cube);
            },
            
            tick: function() {
                // Update the angle for circular motion
                if (this.cube) {
                    this.angle += this.speed;
                    
                    // Calculate new position in a circle
                    const x = this.center.x + this.radius * Math.cos(this.angle);
                    const y = this.center.y + 0.05;
                    const z = this.center.z + this.radius * Math.sin(this.angle);
                    
                    // Update cube position
                    this.cube.position.set(x, y, z);
                    
                    // Rotate the cube as it moves
                    this.cube.rotation.x += 0.01;
                    this.cube.rotation.y += 0.02;
                }
            }
        });
    </script>
</head>
<body>
    <a-scene mindar-image="imageTargetSrc: ./targets.mind;" color-space="sRGB" renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
        <a-assets>
            <img id="card" src="novi_awesome.png" />
        </a-assets>

        <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

        <a-entity mindar-image-target="targetIndex: 0">
            <a-plane src="#card" position="0 0 0" height="0.552" width="1" rotation="0 0 0"></a-plane>
            <a-entity threejs-circle-animation></a-entity>
        </a-entity>
    </a-scene>
</body>
</html>